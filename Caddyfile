# Homepage
eseymour.me {
  root /var/www/eseymour.me/public
  gzip

  # Cache content for an hour
  header / Cache-Control "max-age=3600, public"

  # Git webhook for this repository
  git github.com/eseymour/eseymour.me {
    path ../
    hook /webhook {$GITHUB_WEBHOOK_SECRET}
    then ./build.sh
  }
}

# Test sites
introduction.eseymour.me {
  root /var/www/eseymour.me/introduction/public
  gzip
  header / Cache-Control no-cache
}

minimal.eseymour.me {
  root /var/www/eseymour.me/minimal/public
  gzip
  header / Cache-Control no-cache
}

initio.eseymour.me {
  root /var/www/eseymour.me/initio/public
  gzip
  header / Cache-Control no-cache
}

# www redirect
www.eseymour.me {
  redir https://eseymour.me{uri}
}

# Old domain redirects
http://*.edwardseymour.me http://edwardseymour.me {
  redir https://eseymour.me{uri}
}

https://*.edwardseymour.me https://edwardseymour.me {
  redir https://eseymour.me{uri}
  tls {
    max_certs 50
  }
}
